<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css" />
    <link href="assets/vendor/fonts/circular-std/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/libs/css/style.css" />
    <link rel="stylesheet" href="assets/vendor/fonts/fontawesome/css/fontawesome-all.css" />
    <link rel="stylesheet" href="assets/vendor/charts/chartist-bundle/chartist.css" />
    <link rel="stylesheet" href="assets/vendor/charts/morris-bundle/morris.css" />
    <link rel="stylesheet" href="assets/vendor/fonts/material-design-iconic-font/css/materialdesignicons.min.css" />
    <link rel="stylesheet" href="assets/vendor/charts/c3charts/c3.css" />
    <link rel="stylesheet" href="assets/vendor/fonts/flag-icon-css/flag-icon.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-ABC123" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" integrity="sha384-ABC123" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.3/font/bootstrap-icons.css" integrity="sha384-ABC123" crossorigin="anonymous" />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <title>H.A.W.K Admin page</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- favicon -->
    <link href="assets/images/favicon (3).ico" rel="icon" class="favIcon" />

    <style>
      
      .btn-primary {
        background-image: linear-gradient(to right, #5969ff, #717fe0);
        border-color: #5969ff;
        color: #ffffff;
        transition: transform 0.3s;
      }

      .btn-primary:hover {
        transform: scale(1.03);
        color: white;
      }
      .popup {
  display: none; /* Hide the popup by default */
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
  z-index: 9999;
}



.popup-content {
  background-color: #fff;
  margin: 100px auto;
  padding: 20px;
  max-width: 800px;
  border-radius: 5px;
  position: relative;
  max-height: 400px; /* Set the maximum height of the popup content */
  overflow-y: auto; /* Enable vertical scrollbar */
}

.close {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 20px;
  font-weight: bold;
  cursor: pointer;
}

    </style>
  </head>

  <body>
    <!-- ============================================================== -->
    <!-- main wrapper -->
    <!-- ============================================================== -->
    <div class="dashboard-main-wrapper">
      <!-- ============================================================== -->
      <!-- navbar -->
      <!-- ============================================================== -->
      <div class="dashboard-header">
        <nav class="navbar navbar-expand-lg bg-white fixed-top">
          <a style="color: black" class="navbar-brand" href="index.html"><img src="assets/images/logo.png" style="width: 50px; height: 50px" /><span>H.A.W.K Admin</span></a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto navbar-right-top">
              <li class="nav-item">
              </li>
              <li class="nav-item dropdown nav-user">
                <a class="nav-link nav-user-img" href="#" id="navbarDropdownMenuLink2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                  ><img src="assets/images/user(3).png" alt="" class="user-avatar-md rounded-circle"
                /></a>
                <div class="dropdown-menu dropdown-menu-right nav-user-dropdown" aria-labelledby="navbarDropdownMenuLink2">
                  <div class="nav-user-info" style="background-image: linear-gradient(to right, #000000, #1a1a1a)">
                    <h5 class="mb-0 text-white nav-user-name" id="StaffName"></h5>
                    <span class="status"></span><span class="ml-2" id="StaffRole"></span>
                  </div>
                  <a class="dropdown-item" href="my-profile.html"><i class="fas fa-user mr-2"></i>My profile</a>
                  <a class="dropdown-item" href=# onclick="logout()"><i class="fas fa-power-off mr-2"></i>Logout</a>

                </div>
              </li>
            </ul>
          </div>
        </nav>
      </div>
      <!-- ============================================================== -->
      <!-- end navbar -->
      <!-- ============================================================== -->
      <!-- ============================================================== -->
      <!-- left sidebar -->
      <!-- ============================================================== -->
      <div class="nav-left-sidebar sidebar-dark">
        <div class="menu-list">
          <nav class="navbar navbar-expand-lg navbar-light">
            <a class="d-xl-none d-lg-none" href="index.html">Dashboard</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav flex-column">
                <li class="nav-divider">Menu</li>
                <li class="nav-item">
                  <a class="nav-link active" href="index.html" data-target="#submenu-1" aria-controls="submenu-1"><i class="fa fa-fw fa-user-circle" href="index.html"></i>Dashboard <span class="badge badge-success">6</span></a>
                  <div id="submenu-1" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-1-2" aria-controls="submenu-1-2">E-Commerce</a>
                        <div id="submenu-1-2" class="collapse submenu">
                          <ul class="nav flex-column">
                            <li class="nav-item">
                              <a class="nav-link">H.A.W.K Dashboard</a>
                            </li>
                          </ul>
                        </div>
                      </li>
                    </ul>
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-2" aria-controls="submenu-2"><i class="fa fa-fw fa-table"></i>Table</a>
                  <div id="submenu-2" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="categoryTable.html">Category <span class="badge badge-secondary">New</span></a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="shipperTable.html">Shipper</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="staffTable.html">Staff</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="productTable.html">Product</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="orderTable.html">Order</a>
                      </li>
                      <!-- <li class="nav-item">
                        <a class="nav-link" href="orderDetailTable.html">Order Details</a>
                      </li> -->
                    </ul>
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-3" aria-controls="submenu-3"><i class="fas fa-fw fa-archive"></i>Inventory</a>
                  <div id="submenu-3" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="Restock.html">Input Stock</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="pages/availability.html">Availability</a>
                      </li>
                    </ul>
                  </div>
                </li>

                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-4" aria-controls="submenu-4"><i class="fas fa-fw fa-calendar-alt"></i>Schedule</a>
                  <div id="submenu-4" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="pages/sortable-nestable-lists.html">To-do List</a>
                      </li>
                    </ul>
                  </div>
                </li>

                <li class="nav-divider">Others</li>
                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-6" aria-controls="submenu-6"><i class="fas fa-comments"></i>Social Media </a>
                  <div id="submenu-6" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="https://www.instagram.com/universitasciputra/" target="_blank">Instagram</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="https://www.linkedin.com/school/universitas-ciputra-surabaya/mycompany/" target="_blank">Linkedin</a>
                      </li>
                    </ul>
                  </div>
                </li>

                <li class="nav-item">
                  <a class="nav-link" href="my-profile.html" aria-expanded="false" data-target="#submenu-8" aria-controls="submenu-8"><i class="fas fa-fw fa-user"></i>My Profile</a>
                </li>
                <!-- <li class="nav-item">
                  <a class="nav-liqnk" href="pages/login.html" aria-expanded="false" data-target="#submenu-10" aria-controls="submenu-10"><i class="fas fa-fw fa-sign-out-alt"></i>Logout</a>
                </li> -->
              </ul>
            </div>
          </nav>
        </div>
      </div>
      <!-- ============================================================== -->
      <!-- end left sidebar -->
      <!-- ============================================================== -->
      <!-- ============================================================== -->
      <!-- wrapper  -->
      <!-- ============================================================== -->
      <div class="dashboard-wrapper">
        <div class="dashboard-ecommerce">
          <div class="container-fluid dashboard-content">
            <!-- ============================================================== -->
            <!-- pageheader  -->
            <!-- ============================================================== -->
            <div class="row">
              <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                <div class="page-header">
                  <h2 class="pageheader-title">H.A.W.K Dashboard</h2>
                  <p class="pageheader-text">Nulla euismod urna eros, sit amet scelerisque torton lectus vel mauris facilisis faucibus at enim quis massa lobortis rutrum.</p>
                  <div class="page-breadcrumb">
                    <nav aria-label="breadcrumb">
                      <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#" class="breadcrumb-link">Dashboard</a></li>
                        <li class="breadcrumb-item active" aria-current="page">H.A.W.K Dashboard</li>
                      </ol>
                    </nav>
                  </div>
                </div>
              </div>
            </div>
            <!-- ============================================================== -->
            <!-- end pageheader  -->
            <!-- ============================================================== -->
            <div class="ecommerce-widget">
              <div class="row">
                <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="text-muted">Total Revenue</h5>
                      <div class="metric-value d-inline-block">
                        <h1 class="mb-1"><span id="totalRevenue"></span></h1>
                      </div>
                      <div class="float-right icon-circle-medium  icon-box-lg  bg-brand-light">
                        <i class="fa fa-money-bill-alt fa-fw fa-sm text-brand"></i>
                    </div>
                    </div>

                  </div>
                </div>
                <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="text-muted">Items Sold</h5>
                      <div class="metric-value d-inline-block">
                        <h1 class="mb-1"><span id="itemsSold"></span></h1>
                      </div>
                      <div class="float-right icon-circle-medium icon-box-lg bg-secondary-light">
                        <i class="fa fa-shopping-cart fa-fw fa-sm text-secondary"></i>
                      </div>
                      
                    </div>
  
                  </div>
                </div>
                <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="text-muted">Completed Orders</h5>
                      <div class="metric-value d-inline-block">
                        <h1 class="mb-1"><span id="completedOrders"></span></h1>
                      </div>

                      <div class="float-right icon-circle-medium icon-box-lg bg-success-light">
                        <i class="fa fa-check-circle fa-fw fa-sm text-success"></i>
                      </div>
                      
                    </div>

                  </div>
                </div>
                <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="text-muted">Total Customers</h5>
                      <div class="metric-value d-inline-block">
                        <h1 class="mb-1"><span id="totCust"></span></h1>
                      </div>
                      <div class="float-right icon-circle-medium  icon-box-lg  bg-primary-light ">
                        <i class="fa fa-user fa-fw fa-sm text-primary"></i>
                    </div>
                    </div>
       
                  </div>
                </div>
              </div>
              <div class="row">
                <!-- ============================================================== -->

                <!-- ============================================================== -->

                <!-- recent orders  -->
                <!-- ============================================================== -->
                <div class="col-xl-12 col-lg-12 col-md-6 col-sm-12 col-12">
                  <div class="card p-0">
                    <h5 class="card-header">Recent Orders</h5>
                    <div class="card-body ml-2">
                      <div class="table-responsive">
                        <table class="table">
                      
                            <tr class="border-0" id="recentOrdersHeader">
                            </tr>
                   
                          <tbody id="recentOrdersBody">
                          </tbody>
                          <tfoot>
                            <tr>
                              <td colspan="9"><a href="#" class="btn btn-primary btn-outline-light float-right mt-2" onclick=showPopup()>View Details</a></td>
                            </tr>
                          </tfoot>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- ============================================================== -->
                <!-- The popup -->
<div id="popup" class="popup">
  <div class="popup-content">
    <span class="close" onclick="closePopup()">&times;</span>
    <div class="table-responsive">
      <table class="table">
        <thead class="bg-light">
          <tr class="border-0" id="popupOrdersHeader">
            <!-- Table header columns -->
          </tr>
        </thead>
        <tbody id="popupOrdersBody">
          <!-- Table rows will be dynamically added here using JavaScript -->
        </tbody>
      </table>
    </div>
  </div>
</div>
                <!-- end recent orders  -->

                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- customer acquistion  -->
                <!-- ============================================================== -->

                <!-- ============================================================== -->
                <!-- end customer acquistion  -->
                <!-- ============================================================== -->
              </div>
              <div class="row">
                <!-- ============================================================== -->
                <!-- product category  -->
                <!-- ============================================================== -->
                <div class="col-xl-3 col-lg-6 col-md-6 col-sm-12 col-12">
                  <div class="card">
                    <div class="card">
                      <h5 class="card-header">Products sold</h5>
                      <canvas id="pieChart"></canvas>

                      <div id="c3chart_donut"></div>
                    </div>
                  </div>
                </div>
                <!-- ============================================================== -->
                <!-- end product category  -->

                <!-- ============================================================== -->
                <div class="col-xl-9 col-lg-12 col-md-6 col-sm-12 col-12">
                  <!-- ============================================================== -->
                  <!-- top perfomimg  -->
                  <!-- ============================================================== -->
                  <div class="card">
                    <h5 class="card-header">Best Selling Products</h5>
                    <div class="card-body p-0">
                      <div class="table-responsive" >
                        <div id="topProducts"></div>
                        <td colspan="3">
                          <a href="#" class="btn btn-primary btn-outline-light float-right mr-4 mb-3 mt-2" onclick="showPopupTopProducts()" >Details</a>
                        </td>
                      </tbody>
                      </table>
                      </div>
                    </div>
                  </div>
                  <!-- ============================================================== -->
                  <div id="popupProduct" class="popup">
                    <div class="popup-content">
                      <span class="close" onclick="closePopup()">&times;</span>
                      <div class="table-responsive">
                        <table class="table">
                          <thead class="bg-light">
                            <th class="border-0" id="popupProductsHeader">
                              <!-- Table header columns -->
                            </th>
                          </thead>
                          <tbody id="popupProductsBody">
                            <!-- Table rows will be dynamically added here using JavaScript -->
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                  <!-- end top perfomimg  -->
                  <!-- ============================================================== -->
                </div>
              </div>

              <div class="row">
                <!-- ============================================================== -->
                <!-- sales  -->
                <!-- ============================================================== -->

                <!-- ============================================================== -->
                <!-- end sales  -->
                <!-- ============================================================== -->
                <!-- ===============================================z=============== -->
                <!-- new customer  -->
                <!-- ============================================================== -->

                <!-- ============================================================== -->
                <!-- end new customer  -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- visitor  -->
                <!-- ============================================================== -->

                <!-- ============================================================== -->
                <!-- end visitor  -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- total orders  -->
                <!-- ============================================================== -->

                <!-- ============================================================== -->
                <!-- end total orders  -->
                <!-- ============================================================== -->
              </div>
              <div class="row">
                <!-- ============================================================== -->
                <!-- total revenue  -->
                <!-- ============================================================== -->

                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- category revenue  -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- end category revenue  -->
                <!-- ============================================================== -->

                <div class="col-xl-12 col-lg-7 col-md-12 col-sm-12 col-12">
                  <div class="card">
                    <h5 class="card-header">Total Revenue</h5>
                    <div class="card-body">
                      <div class="card-body">
                        <canvas id="lineChart"></canvas>
                      </div>
                    </div>
                    <div class="card-footer">
                      <?php include 'total_revenue_footer.php'; ?>
                    </div>
                  </div>
                </div>
              </div>
              <!-- ============================================================== -->
              <!-- sales traffice source  -->
              <!-- ============================================================== -->

              <!-- ============================================================== -->
              <!-- end sales traffice source  -->
              <!-- ============================================================== -->
              <!-- ============================================================== -->
              <!-- sales traffic country source  -->
              <!-- ============================================================== -->
              <div class="col-xl-12 col-lg-5 col-md-12 col-sm-12 col-12">
                <div class="card">
                  <h5 class="card-header">Best Selling Brands</h5>
                  <div class="card-body p-0">
                    <ul class="country-sales list-group list-group-flush">
                      <div id="topBrands"></div>
                    </ul>
                  </div>
                </div>
              </div>
              <!-- ============================================================== -->
              <!-- end sales traffice country source  -->
              <!-- ============================================================== -->
            </div>
          </div>
        </div>
        <!-- ============================================================== -->
        <!-- footer -->
        <!-- ============================================================== -->
        <div class="footer">
          <div class="container-fluid">
            <div class="row">
              <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">Copyright © 2018 Concept. All rights reserved. Dashboard by <a href="https://colorlib.com/wp/">Colorlib</a>.</div>
              <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                <div class="text-md-right footer-links d-none d-sm-block">
                  <a href="javascript: void(0);">About</a>
                  <a href="javascript: void(0);">Support</a>
                  <a href="javascript: void(0);">Contact Us</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- ============================================================== -->
        <!-- end footer -->
        <!-- ============================================================== -->
      </div>
      <!-- ============================================================== -->
      <!-- end wrapper  -->
      <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- end main wrapper  -->
    <!-- ============================================================== -->
    <!-- Optional JavaScript -->
    <!-- jquery 3.3.1 -->
    <script src="assets/vendor/jquery/jquery-3.3.1.min.js"></script>
    <!-- bootstap bundle js -->
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
    <!-- slimscroll js -->
    <script src="assets/vendor/slimscroll/jquery.slimscroll.js"></script>
    <!-- main js -->
    <script src="assets/libs/js/main-js.js"></script>
    <!-- chart chartist js -->
    <script src="assets/vendor/charts/chartist-bundle/chartist.min.js"></script>
    <!-- sparkline js -->
    <script src="assets/vendor/charts/sparkline/jquery.sparkline.js"></script>
    <!-- morris js -->
    <script src="assets/vendor/charts/morris-bundle/raphael.min.js"></script>
    <script src="assets/vendor/charts/morris-bundle/morris.js"></script>
    <!-- chart c3 js -->
    <script src="assets/vendor/charts/c3charts/c3.min.js"></script>
    <script src="assets/vendor/charts/c3charts/d3-5.4.0.min.js"></script>
    <script src="assets/vendor/charts/c3charts/C3chartjs.js"></script>
    <script src="assets/libs/js/dashboard-ecommerce.js"></script>
    <script>
      $(document).ready(function() {
    fetch('chartCategory.php')
        .then(response => response.json())
        .then(data => {
            // Separate the category names and sums
            const categories = data.map(row => row.Category);
            const sums = data.map(row => row.sum);

            // Create the pie chart
            new Chart(document.getElementById('pieChart'), {
                type: 'pie',
                data: {
                    labels: categories,
                    datasets: [{
                        data: sums,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                        ],
                    }],
                },
                options: {
                    responsive: true,
                    legend: {
                        position: 'bottom',
                    },
                },
            });
        })
        .catch(error => console.error(error));
  });
  

    var dSummary = "dashboardSummary.php";
    var recentOrdersUrl = "recentOrders.php";
    var topProductsUrl = "topProducts.php";


    function loadData(url, query, targetElement) {
      $.ajax({
        url: url,
        method: "POST",
        data: { query: query },
        success: function(response) {
          $(targetElement).html(response);
        },
      });
    }

    var totalRevQuery = "select substr(format(sum(order_grandtotal),0),1,6) as 'Total Revenue' from `order`;"
    loadData(dSummary, totalRevQuery, "#totalRevenue");
    var ItemsSold = "select sum(order_quantity) as 'Items Sold' from `order`;"
    loadData(dSummary, ItemsSold, "#itemsSold")
    var completedOrders = "select count(order_id) as 'Completed orders' from `order` where order_updated is not null;"
    loadData(dSummary, completedOrders, "#completedOrders")
    var totalCust = "select count(customer_id) as 'Total Customers' from customers;"
    loadData(dSummary, totalCust, "#totCust")



    var recentOrder = "SELECT p.product_name AS 'Product Name', SUM(od.quantity) AS Quantity, CONCAT('Rp. ', FORMAT(p.product_price, 0)) AS Price, CONCAT('Rp. ', FORMAT(p.product_price * SUM(od.quantity), 0)) AS 'Total price', od.order_detail_created AS 'Order Time', CONCAT(c.customer_firstName, ' ', c.customer_lastName) AS Customer, IF(order_updated IS NULL, 'On-process', 'Delivered') AS `Status` FROM product p, customers c, `order` o, order_detail od WHERE o.customer_id = c.customer_id AND od.product_id = p.product_id AND o.order_id = od.order_id GROUP BY od.order_detail_id ORDER BY od.order_detail_id DESC LIMIT 5;";
    loadData(recentOrdersUrl, recentOrder, "#recentOrdersBody", "#recentOrdersHeader");

    var topProduk = "select p.product_name as 'Product Name', sum(od.quantity) as 'Sold', concat('Rp. ',format(sum(od.quantity)*od.price,0)) as 'Revenue' from product p, order_detail od where od.product_id=p.product_id group by od.product_id order by 2 desc limit 6;";
    loadData(topProductsUrl, topProduk, "#topProducts");


function showPopup() {
  // Display the popup
  document.getElementById("popup").style.display = "block";

  // Fetch the recent orders using AJAX and populate the popup table
  var recentOrdersUrl = "recentOrders.php";
  var recentOrderQuery = "SELECT p.product_name AS 'Product Name', SUM(od.quantity) AS Quantity, CONCAT('Rp. ', FORMAT(p.product_price, 0)) AS Price, CONCAT('Rp. ', FORMAT(p.product_price * SUM(od.quantity), 0)) AS 'Total price', od.order_detail_created AS 'Order Time', CONCAT(c.customer_firstName, ' ', c.customer_lastName) AS Customer, IF(order_updated IS NULL, 'On-process', 'Delivered') AS `Status` FROM product p, customers c, `order` o, order_detail od WHERE o.customer_id = c.customer_id AND od.product_id = p.product_id AND o.order_id = od.order_id GROUP BY od.order_detail_id ORDER BY od.order_detail_id DESC;";
  loadData(recentOrdersUrl, recentOrderQuery, "#popupOrdersHeader", "#popupOrdersBody");
}

function showPopupTopProducts() {
  // Display the popup
  document.getElementById("popupProduct").style.display = "block";

  // Fetch the recent orders using AJAX and populate the popup table
  var productURL = "topProducts.php";
  var topProductsDetail = "select p.product_name as 'Product Name', sum(od.quantity) as 'Sold', concat('Rp. ',format(sum(od.quantity)*od.price,0)) as 'Revenue' from product p, order_detail od where od.product_id=p.product_id group by od.product_id order by 2 desc;";
  loadData(productURL, topProductsDetail, "#popupProductsHeader", "#popupProductsBody");
}


function closePopup() {
  // Hide the popup
  document.getElementById("popup").style.display = "none";
  document.getElementById("popupProduct").style.display = "none";
}
fetch('topBrands.php')
  .then(response => response.json())
  .then(data => {
    // Process the data and update the HTML
    const list = document.getElementById('topBrands');
    data.forEach(row => {
      const brand = row.product_brand;
      const percentage = row.sold_percentage;

      const listItem = document.createElement('li');
      listItem.classList.add('country-sales-content', 'list-group-item');

      const brandIcon = document.createElement('i');
      brandIcon.classList.add('brand-icon', 'gucci');
      brandIcon.title = brand;

      const brandImage = new Image();
      brandImage.onload = function() {
        // Image exists, append it to the brandIcon
        brandIcon.appendChild(brandImage);
      };
      brandImage.onerror = function() {
        // Image does not exist, skip displaying any picture
        brandIcon.style.display = 'none';
      };
      brandImage.src = `assets/images/${brand.toLowerCase()}.png`;
      brandImage.style.width = '32px';

      const brandName = document.createElement('span');
      brandName.textContent = brand;

      const percentageText = document.createElement('span');
      percentageText.classList.add('float-right', 'text-dark');
      percentageText.textContent = `${percentage}%`;

      listItem.appendChild(brandIcon);
      listItem.appendChild(brandName);
      listItem.appendChild(percentageText);

      list.appendChild(listItem);
    });
  })
  .catch(error => {
    console.log('Error fetching data:', error);
  });
  

    </script>
    <script>
      // Fetch data from the PHP file
      fetch('total_revenue.php')
        .then(response => response.json())
        .then(data => {
          // Process the data and populate date and revenues arrays
          var date = [];
          var revenues = [];
          data.data.forEach(row => {
            date.push(row.order_detail_created);
            revenues.push(row.total_revenue);
          });

          // Create the line chart
          var ctx = document.getElementById('lineChart').getContext('2d');
          var lineChart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: date,
              datasets: [{
                label: 'Total Revenue',
                data: revenues,
                backgroundColor: 'rgba(0, 123, 255, 0.2)',
                borderColor: 'rgba(0, 123, 255, 1)',
                borderWidth: 1
              }]
            },
            options: {
              scales: {
                y: {
                  beginAtZero: true
                }
              }
            }
          });

          // Update the total revenue in the card footer
          var totalRevenueElement = document.querySelector('.card-footer .display-7 .text-primary');
          if (totalRevenueElement) {
            totalRevenueElement.textContent = 'Rp ' + data.totalRevenue.toLocaleString('id-ID');
          }
        })
        .catch(error => console.log(error));
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css">
    
    <script>
      function logout() {
        Swal.fire({
          title: 'Logout Confirmation',
          text: 'Are you sure you want to logout?',
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#3085d6',
          cancelButtonColor: '#d33',
          confirmButtonText: 'Yes, logout',
          cancelButtonText: 'Cancel'
        }).then((result) => {
          if (result.isConfirmed) {
            // Redirect to the logout script
            window.location.href = 'pages/login.html';
          }
        });
      }
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Fetch user data from the server
        fetch('my-profile.php')
          .then(response => response.json())
          .then(userData => {
            // Update HTML elements with user data
          
            document.getElementById('StaffName').textContent = userData.staff_name;
            document.getElementById('StaffRole').textContent = userData.staff_role;
          })
          .catch(error => console.error(error));
      });
    </script>    
    
  </body>
</html>
