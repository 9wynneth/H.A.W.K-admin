<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css" />
    <link href="assets/vendor/fonts/circular-std/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/libs/css/style.css" />
    <link rel="stylesheet" href="assets/vendor/fonts/fontawesome/css/fontawesome-all.css" />

    <title>My Profile</title>

    <!-- favicon -->
    <link href="assets/images/favicon (3).ico" rel="icon" class="favIcon" />

    <style>
        /* .card:hover {
            background-image: linear-gradient(to right, #5969ff, #717fe0);
        color: white;
    } */
    </style>
  </head>

  <body>
    <!-- ============================================================== -->
    <!-- main wrapper -->
    <!-- ============================================================== -->
    <div class="dashboard-main-wrapper">
      <!-- ============================================================== -->
      <!-- navbar -->
      <!-- ============================================================== -->
      <div class="dashboard-header">
        <nav class="navbar navbar-expand-lg bg-white fixed-top">
          <a style="color: black" class="navbar-brand" href="index.html"><img src="assets/images/logo.png" style="width: 50px; height: 50px" />H.A.W.K Admin</a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto navbar-right-top">
              <li class="nav-item">

              </li>
              
              <li class="nav-item dropdown nav-user">
                <a class="nav-link nav-user-img" href="#" id="navbarDropdownMenuLink2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                  ><img src="assets/images/user(3).png" alt="" class="user-avatar-md rounded-circle"
                /></a>
                <div class="dropdown-menu dropdown-menu-right nav-user-dropdown" aria-labelledby="navbarDropdownMenuLink2">
                  <div class="nav-user-info" style="background-image: linear-gradient(to right, #000000, #1a1a1a)">
                    <h5 class="mb-0 text-white nav-user-name"></h5>
                    <span class="status"></span><span class="ml-2">Owner</span>
                  </div>
                  <a class="dropdown-item" href="my-profile.html"><i class="fas fa-user mr-2"></i>My profile</a>
                  <a class="dropdown-item" href="pages/login.html"><i class="fas fa-power-off mr-2"></i>Logout</a>
                </div>
              </li>
            </ul>
          </div>
        </nav>
      </div>
      <!-- ============================================================== -->
      <!-- end navbar -->
      <!-- ============================================================== -->
      <!-- ============================================================== -->
      <!-- left sidebar -->
      <!-- ============================================================== -->
      <div class="nav-left-sidebar sidebar-dark">
        <div class="menu-list">
          <nav class="navbar navbar-expand-lg navbar-light">
            <a class="d-xl-none d-lg-none" href="index.html">Dashboard</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav flex-column">
                <li class="nav-divider">Menu</li>
                <li class="nav-item">
                  <a class="nav-link" href="index.html" data-target="#submenu-1" aria-controls="submenu-1"><i class="fa fa-fw fa-user-circle" href="index.html"></i>Dashboard <span class="badge badge-success">6</span></a>
                  <div id="submenu-1" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-1-2" aria-controls="submenu-1-2">E-Commerce</a>
                        <div id="submenu-1-2" class="collapse submenu">
                          <ul class="nav flex-column">
                            <li class="nav-item">
                              <a class="nav-link">H.A.W.K Dashboard</a>
                            </li>
                          </ul>
                        </div>
                      </li>
                    </ul>
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-2" aria-controls="submenu-2"><i class="fa fa-fw fa-table"></i>Table</a>
                  <div id="submenu-2" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="categoryTable.html">Category <span class="badge badge-secondary">New</span></a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="shipperTable.html">Shipper</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="staffTable.html">Staff</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="productTable.html">Product</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="orderTable.html">Order</a>
                      </li>
                      <!-- <li class="nav-item">
                        <a class="nav-link" href="orderDetailTable.html">Order Details</a>
                      </li> -->
                    </ul>
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-3" aria-controls="submenu-3"><i class="fas fa-fw fa-archive"></i>Inventory</a>
                  <div id="submenu-3" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="Restock.html">Input Stock</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="pages/availability.html">Availability</a>
                      </li>
                    </ul>
                  </div>
                </li>

                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-4" aria-controls="submenu-4"><i class="fas fa-fw fa-calendar-alt"></i>Schedule</a>
                  <div id="submenu-4" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="pages/sortable-nestable-lists.html">To-do List</a>
                      </li>
                    </ul>
                  </div>
                </li>



                <li class="nav-divider">Others</li>
                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false" data-target="#submenu-6" aria-controls="submenu-6"><i class="fas fa-comments"></i>Social Media </a>
                  <div id="submenu-6" class="collapse submenu">
                    <ul class="nav flex-column">
                      <li class="nav-item">
                        <a class="nav-link" href="../pages/404-page.html">Instagram</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="../pages/404-page.html">Facebook</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="../pages/404-page.html">Linkedin</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="../pages/404-page.html">Whatsapp Group</a>
                      </li>
                    </ul>
                  </div>
                </li>

                <li class="nav-item active">
                  <a class="nav-link active" href="my-profile.html" aria-expanded="false" data-target="#submenu-8" aria-controls="submenu-8"><i class="fas fa-fw fa-user"></i>My Profile</a>
                </li>
                <li class="nav-item">
                  <a class="nav-liqnk" href="pages/login.html" aria-expanded="false" data-target="#submenu-10" aria-controls="submenu-10"><i class="fas fa-fw fa-sign-out-alt"></i>Logout</a>
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
      <!-- ============================================================== -->
      <!-- end left sidebar -->
      <!-- ============================================================== -->
      <!-- ============================================================== -->
      <!-- wrapper  -->
      <!-- ============================================================== -->
      <div class="dashboard-wrapper">
        <div class="influence-profile">
          <div class="container-fluid dashboard-content">
            <!-- ============================================================== -->
            <!-- pageheader -->
            <!-- ============================================================== -->
            <div class="row">
              <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                <div class="page-header">
                  <h3 class="mb-2">My Profile</h3>
                  <p class="pageheader-text">Proin placerat ante duiullam scelerisque a velit ac porta, fusce sit amet vestibulum mi. Morbi lobortis pulvinar quam.</p>
                  <div class="page-breadcrumb">
                    <nav aria-label="breadcrumb">
                      <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#" class="breadcrumb-link">Dashboard</a></li>
                        <li class="breadcrumb-item active" aria-current="page">My Profile</li>
                      </ol>
                    </nav>
                  </div>
                </div>
              </div>
            </div>
            <!-- ============================================================== -->
            <!-- end pageheader -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- content -->
            <!-- ============================================================== -->
            <div class="row">
              <!-- ============================================================== -->
              <!-- profile -->
              <!-- ============================================================== -->
              <div class="col-xl-3 col-lg-3 col-md-5 col-sm-12 col-12">
                <!-- ============================================================== -->
                <!-- card profile -->
                <!-- ============================================================== -->
                <div class="card">
                  <div class="card-body">
                    <div class="user-avatar text-center d-block"></div>
                    <div class="text-center">
                      <h2 class="font-24 mb-0" id="staffName"></h2>
                      <p>@H.A.W.K</p>
                    </div>
                  </div>
                  <div class="card-body border-top" style="height: 486px;">
                    <h3 class="font-16">Contact Information</h3>
                    <div class="">
                      <ul class="list-unstyled mb-0">
                        <li class="mb-2"><h6 style="display: inline;">Staff ID: </h6><p id="staffId" style="display: inline;"></p></li>
                        <li class="mb-0"><h6 style="display: inline;">Role: </h6><p id="staffRole" style="display: inline;"></p></li>
                      </ul>
                    </div>
                    <div class="text-center pt-66" style="margin-top: 95px; size: 180%;">
                        <img src="assets/images/logo.png">
                    </div>
                  </div>
                </div>
                <!-- ============================================================== -->
                <!-- end card profile -->
                <!-- ============================================================== -->
              </div>
              <!-- ============================================================== -->
              <!-- end profile -->
              <!-- ============================================================== -->
              <!-- ============================================================== -->
              <!-- campaign data -->
              <!-- ============================================================== -->
              <div class="col-xl-9 col-lg-9 col-md-7 col-sm-12 col-12">
                <!-- ============================================================== -->
                <!-- campaign tab one -->
                <!-- ============================================================== -->
                <div class="influence-profile-content pills-regular">
                  <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-campaign" role="tabpanel" aria-labelledby="pills-campaign-tab">
                      <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                          <div class="section-block">
                            <h3 class="section-title">My Stats</h3>
                          </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12">
                          <div class="card">
                            <div class="card-body">
                              <h1 class="mb-1" id="totalStocksAllocated"></h1>
                              <p>Tot. Stocks allocated</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12">
                          <div class="card">
                            <div class="card-body">
                              <h1 class="mb-1" id="totalProductsAllocated"></h1>
                              <p>Products allocated</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12">
                          <div class="card">
                            <div class="card-body">
                              <h1 class="mb-1" id="allocationFreq"></h1>
                              <p>Allocation Frequency</p>
                            </div>
                          </div>
                        </div>


                        <div class="col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12">
                          <div class="card">
                            <div class="card-body text-center">
                            <div id="badgeRole"></div>
                          </div>
                        </div>
                      </div>

                      <div class="col-xl-12 col-lg-12 col-md-24 col-sm-48 col-48">
                      <div class="card">
                        <div class="card-body">
                        <canvas id="barchartStocks" ></canvas>
                        </div>
                      </div>
                      </div>
  
                      </div>
                    </div>
                    
                  </div>
                </div>
                <!-- ============================================================== -->
                <!-- end campaign tab one -->
                <!-- ============================================================== -->
              </div>
              <!-- ============================================================== -->
              <!-- end campaign data -->
              <!-- ============================================================== -->
            </div>
          </div>
        </div>
        <!-- ============================================================== -->
        <!-- end content -->
        <!-- ============================================================== -->

        <!-- ============================================================== -->
        <!-- end footer -->
        <!-- ============================================================== -->
      </div>
      <!-- ============================================================== -->
      <!-- end wrapper -->
      <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- end main wrapper -->
    <!-- ============================================================== -->
    <!-- Optional JavaScript -->
    <!-- jquery 3.3.1  -->
    <script src="assets/vendor/jquery/jquery-3.3.1.min.js"></script>
    <!-- bootstap bundle js -->
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
    <!-- slimscroll js -->
    <script src="assets/vendor/slimscroll/jquery.slimscroll.js"></script>
    <!-- main js -->
    <script src="assets/libs/js/main-js.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>

      var badgeURL = 'badgeRole.php';

      function loadData(url, query, targetElement) {
      $.ajax({
        url: url,
        method: "POST",
        data: { query: query },
        success: function(response) {
          $(targetElement).html(response);
        },
      });
    }

    var badgeQ = "select staff_role from staff where staff_id='A0001'"
    loadData(badgeURL, badgeQ, "#badgeRole");
      
$(document).ready(function() {
    fetch('chartStockAllocated.php')
        .then(response => response.json())
        .then(data => {
            // Separate the staff names and total stocks allocated
            const staffNames = data.map(row => row.staff_name);
            const totalStocksAllocated = data.map(row => row['Total Stocks Allocated']);

            // Create the bar chart
            new Chart(document.getElementById('barchartStocks'), {
                type: 'bar',
                data: {
                    labels: staffNames,
                    datasets: [{
                        label: 'Total Stocks Allocated',
                        data: totalStocksAllocated,
                        backgroundColor: '#5969ff', // Change the bar color if needed
                    }],
                },
                options: {
                    responsive: true,
                    legend: {
                        display: false,
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true,
                            },
                        }],
                    },
                },
            });
        })
        .catch(error => console.error(error));
});


      document.addEventListener('DOMContentLoaded', function() {
        // Fetch user data from the server
        fetch('my-profile.php')
          .then(response => response.json())
          .then(userData => {
            // Update HTML elements with user data
            document.getElementById('staffId').textContent = userData.staff_id;
            document.getElementById('staffName').textContent = userData.staff_name;
            document.getElementById('staffRole').textContent = userData.staff_role;
    
            // Fetch the total allocated stocks for the user
            fetch('stocksAllocate.php?staff_id=' + userData.staff_id)
              .then(response => response.json())
              .then(result => {
                // Update the totalStocksAllocated element with the count
                document.getElementById('totalStocksAllocated').textContent = result.totalAllocated;
              })
            fetch('productsAllocate.php?staff_id=' + userData.staff_id)
              .then(response => response.json())
              .then(result => {
                // Update the totalProductsAllocated element with the count
                document.getElementById('totalProductsAllocated').textContent = result.productAllocated;
              })
            fetch('allocationFreq.php?staff_id=' + userData.staff_id)
              .then(response => response.json())
              .then(result => {
                // Update the totalProductsAllocated element with the count
                document.getElementById('allocationFreq').textContent = result.allocationFreq;
              })
          })
          .catch(error => console.error(error));
      });
    </script>    
  </body>
</html>
